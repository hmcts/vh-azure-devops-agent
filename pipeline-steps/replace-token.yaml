parameters:
  - name: myConnection
    type: string
  - name: workingDirectory
    type: string
  - name: environment
    type: string
steps:

  - task: Bash@3
    displayName: Personal Access Token Replacement
    inputs:
      targetType: 'inline'
      workingDirectory: ${{parameters.workingDirectory}}
      script: |
          echo 'Replacing pat token with ${{parameters.myConnection}}'
          sed -i 's|REPLACE|${{parameters.myConnection}}|gI' 'set_up.sh'
          echo 'Updating agent name'
          sed -i 's|ENV|${{parameters.environment}}|gI' 'set_up.sh'